`r if(knitr:::is_latex_output()) '\\startappendices'`

`r if(!knitr:::is_latex_output()) '# (APPENDIX) Appendix {-}'` 

<!-- If you feel it necessary to include an appendix, it goes here. The first appendix should include the commands above. -->


# Appendix

```{r price-dist-per-designer,echo = FALSE, warning = FALSE, message = FALSE, results = 'hide', fig.cap="Price Distribution per Designer", out.width="100%"}
tidy_ikea %>%
  ggplot(mapping = aes(x = fct_reorder(fct_lump(tidy_ikea$designer, 25), price_eur), y = price_eur, colour = fct_lump(tidy_ikea$designer, 25))) +
    geom_boxplot(width = 0.4, outlier.size = 0.5, outlier.alpha = 0.3,  show.legend = FALSE) +
    theme_minimal() +
    labs(x = "", y = "price in €", fill = "", title = "Price Distribution per Designer") +
    coord_flip()
```

```{r price-dist-per-category,echo = FALSE, warning = FALSE, message = FALSE, results = 'hide', fig.cap="Price Distribution per Category", out.width="100%"}
tidy_ikea %>%
  ggplot(aes(x = reorder(fct_lump(tidy_ikea$category, 15), price_eur), y = price_eur, colour = fct_lump(tidy_ikea$category, 15))) +
    geom_boxplot(width = 0.4, outlier.size = 0.5, outlier.alpha = 0.3,  show.legend = FALSE) +
    scale_color_manual(values = mycolors) +
    theme_minimal() +
    labs(x = "", y = "price in €", fill = "", title = "Price Distribution per Category") +
    coord_flip()
```

```{r price-dist-other-colors,echo = FALSE, warning = FALSE, message = FALSE, results = 'hide', fig.cap="Price Distribution Other Colors", out.width="100%"}
knitr::opts_chunk$set(fig.pos = '!h')

tidy_ikea %>%
  ggplot(aes(x = price_eur, y = other_colors, color = other_colors)) +
  geom_boxplot(width = 0.4, outlier.size = 0.5, outlier.alpha = 0.3,  show.legend = FALSE) +
  scale_color_manual(values = mycolors) +
  theme_minimal() +
  labs(x = "price in €", y = "other_colors", fill = "", title = "Price Distribution Other Colors")
```


```{r price-dist-sellable-online,echo = FALSE, warning = FALSE, message = FALSE, results = 'hide', fig.cap="Price Distribution Sellable Online", out.width="100%"}
tidy_ikea %>%
  ggplot(aes(x = price_eur, y = sellable_online, color = sellable_online)) +
    geom_boxplot(width = 0.4, outlier.size = 0.5, outlier.alpha = 0.3,  show.legend = FALSE) +
    scale_color_manual(values = mycolors) +
    theme_minimal() +
    labs(x = "price in €", y = "sellable_online", fill = "", title = "Price Distribution Sellable Online")
```

```{r relationship-x-y, echo = FALSE, warning = FALSE, message = FALSE, results = 'hide', fig.cap="Relationship between Independent Variables and Price", out.width="100%"}
tidy_ikea %>%
  mutate(across(where(is.character), as.factor)) %>% mutate(across(where(is.factor), as.numeric)) %>%
  # select() %>% # De-select variables here if necessary
  pivot_longer(-price_eur, names_to = "variable", values_to = "num") %>% group_by(variable) %>%
  arrange(num) %>%
  mutate(observation = 1:n()) %>%
  ungroup() %>%
  ggplot(aes(x = num, y = price_eur)) + theme_bw() +
  geom_point(shape = 1, alpha = 0.8, position = "jitter") +
  geom_smooth(se = FALSE, colour = "blue", method = "loess", formula = 'y ~ x') +
  facet_wrap(~ variable, scales = "free_x") + ylab("Price in €") + xlab("")
```

# Bibliography
